!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SimpleDomComponent=t():e.SimpleDomComponent=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(6)},function(e,t){"use strict";function n(e){return!!(e&&e.constructor&&e.call&&e.apply)}function r(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function o(e){return Array.isArray(e)?e.reduce(function(e,t){return e.concat(Array.isArray(t)?o(t):t)},[]):e}Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=n,t.dasherize=r,t.flatten=o},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(){return s++}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=1;t.Store=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.state=t,this.subscribers={},this.componentsSubscribes=[]}return i(e,[{key:"updateState",value:function(e){var t=this.state;this.state=o({},this.state,e);for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var s=r.concat("*"),u=s.length;u--;){var a=s[u];if(this.subscribers[a])for(var c in this.subscribers[a])this.subscribers[a].hasOwnProperty(c)&&this.subscribers[a][c](a,this.state,t)}}},{key:"subscribe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){},n=arguments[2];this.subscribers[e]||(this.subscribers[e]={});var o=r();if(this.subscribers[e][o]=t,n){var i=void 0,s=!0,u=!1,a=void 0;try{for(var c,f=this.componentsSubscribes[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var l=c.value;if(l.component===n){i=l;break}}}catch(e){u=!0,a=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw a}}i||(i={component:n,subscribes:[]},this.componentsSubscribes.push(i)),i.subscribes.push({event:e,id:o})}return o}},{key:"unsubsribe",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=Object.keys(this.subscribers)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value;this.subscribers[s][e]&&delete this.subscribers[s][e]}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"unsubscribeAll",value:function(){this.subscribers={},this.componentsSubscribes=[]}},{key:"unsubscribeByEventAndId",value:function(e,t){this.subscribers[e][t]&&delete this.subscribers[e][t]}}]),e}()},function(e,t,n){"use strict";function r(e,t){for(var n in t.attrs)t.attrs.hasOwnProperty(n)&&void 0!==t.attrs[n]&&!function(){var r=t.attrs[n];if("ref"===n)r(e);else if(n.startsWith("on")){var o=n.substring(2).toLowerCase();e.addEventListener(o,function(e){return r(e)})}else if("className"===n&&(n="class"),n=(0,s.dasherize)(n),"style"===n&&"[object Object]"==Object.prototype.toString.call(r))for(var i in r)r.hasOwnProperty(i)&&(e.style[(0,s.dasherize)(i)]=r[i]);else if("class"===n&&"[object Object]"==Object.prototype.toString.call(r))for(var u in r)r.hasOwnProperty(u)&&r[u]&&e.classList.add((0,s.dasherize)(u));else e.setAttribute(n,r)}()}function o(e,t,n){if(void 0!==e&&null!==e){if(e.isComponent){var s=new e.componentClass(i({},e.props),t);return n.push(s),o(s.renderComponent(),t,n)}if(!e.isElem)return e.__asHtml?e:document.createTextNode(""+e);var u=document.createElement(e.name);r(u,e);for(var a=e.children.length,c=0;c<a;c++){var f=e.children[c];if(void 0!==f&&null!==f){var l=o(f,t,n);void 0!==l&&null!==l&&(l.__asHtml?u.insertAdjacentHTML("beforeend",l.__asHtml):u.appendChild(l))}}return u}}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.updateAttrs=r,t.convertToNode=o;var s=n(1)},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];if(e&&e.isComponent){var i=l({},t,{children:((0,v.flatten)(r)||[]).filter(function(e){return null!==e&&void 0!==e})});return{isComponent:!0,componentClass:e,props:i}}return(0,v.isFunction)(e)?e.apply(void 0,[t].concat(r)):{name:e,attrs:t||{},children:((0,v.flatten)(r)||[]).filter(function(e){return null!==e&&void 0!==e}),isElem:!0}}function i(e){var t=e;for("string"==typeof e&&(t=document.getElementById(e));t.firstChild;)t.removeChild(t.firstChild);return t}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new h.Store;u(e,[t],n)}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new h.Store,r=i(e),o=[];if((0,v.flatten)(t).filter(function(e){return void 0!==e&&null!==e}).map(function(e){return(0,d.convertToNode)(e,n,o)}).forEach(function(e){return r.appendChild(e)}),o.forEach(function(e){return e.componentDidMount()}),o.length){var s=new MutationObserver(function(){document.body.contains(r)||(s.disconnect(),n.unsubscribeAll());for(var e=n.componentsSubscribes.length-1;e>=0;e--){var t=n.componentsSubscribes[e];t.component.node&&!r.contains(t.component.node)&&(t.subscribes.forEach(function(e){var t=e.event,r=e.id;return n.unsubscribeByEventAndId(t,r)}),t.component.node=void 0,n.componentsSubscribes.splice(e,1))}});s.observe(document.body,{childList:!0,subtree:!0})}}function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,v.flatten)(t).map(function(e){if(!e.name)return""+(e.__asHtml||e);var t=Object.keys(e.attrs).filter(function(t){return!t.startsWith("on")&&void 0!==e.attrs[t]&&"ref"!==t}).map(function(t){var n=(0,v.dasherize)("className"===t?"class":t),r=e.attrs[t];return"style"===n&&"object"===("undefined"==typeof r?"undefined":f(r))?r=Object.keys(r).map(function(e){return""+(0,v.dasherize)(e)+":"+r[e]}).join(";"):"class"===n&&"object"===("undefined"==typeof r?"undefined":f(r))&&(r=Object.keys(r).filter(function(e){return r[e]}).map(v.dasherize).join(" "))," "+n+'="'+r+'"'}).join(""),n=a.apply(void 0,r(e.children));return"<"+e.name+t+">"+n+"</"+e.name+">"}).join("")}function c(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];u(e,n)}Object.defineProperty(t,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.el=o,t.renderToDom=s,t.renderToString=a,t.renderTo=c;var d=n(3),v=n(1),h=n(2)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4),s=n(3),u=t.Component=function(){function e(t){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;r(this,e),this.props=t,this.store=o,Object.getOwnPropertyNames(Object.getPrototypeOf(this)).filter(function(e){return"constructor"!==e}).filter(function(e){return n[e]instanceof Function}).forEach(function(e){return n[e]=n[e].bind(n)});var i=!0,s=!1,u=void 0;try{for(var a,c=this.eventsToSubscribe()[Symbol.iterator]();!(i=(a=c.next()).done);i=!0){var f=a.value;this.store.subscribe(f,this.reactToChangeState.bind(this),this)}}catch(e){s=!0,u=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw u}}}return o(e,[{key:"state",get:function(){return this.store.state}}]),o(e,[{key:"nodeRefHandler",value:function(e){this.node=e,this.otherRef&&this.otherRef(e)}},{key:"refresh",value:function(){var e=[],t=this.node;this.node=null;var n=(0,s.convertToNode)(this.renderComponent(),this.store,e);return void 0===n&&null===n?(t.parentNode.removeChild(t),void this.componentDidMount()):(t.parentNode.replaceChild(n,t),void e.forEach(function(e){return e.componentDidMount()}))}},{key:"reactToChangeState",value:function(e,t,n){this.mustRefresh(n,t)&&this.node&&(this.refresh(),this.componentDidMount())}},{key:"eventsToSubscribe",value:function(){return[]}},{key:"mustRefresh",value:function(e,t){return!0}},{key:"componentDidMount",value:function(){}},{key:"renderComponent",value:function(e){var t=this,n=this.render();if(this.otherRef=e,void 0===n||null===n)return(0,i.el)("div",{ref:function(e){return t.nodeRefHandler(e)},style:{width:0,height:0}});if(n.isElem){var r=n.attrs.ref;n.attrs.ref=function(e){r&&r(e),t.nodeRefHandler(e)}}else n.isComponent?n.otherRef=function(e){return t.nodeRefHandler(e)}:console.error("Unkown result type for a component",n);return n}},{key:"render",value:function(){}}]),e}();u.isComponent=!0},function(e,t,n){"use strict";function r(e,t,n){var r=(0,u.isFunction)(e)?e():e;return r?(0,u.isFunction)(t)?t():t:(0,u.isFunction)(n)?n():n}Object.defineProperty(t,"__esModule",{value:!0}),t.predicate=r;var o=n(5),i=n(2),s=n(4),u=n(1);t.Component=o.Component,t.Store=i.Store,t.el=s.el,t.renderToDom=s.renderToDom,t.renderTo=s.renderTo,t.renderToString=s.renderToString}])});
//# sourceMappingURL=simpledom-component.js.map